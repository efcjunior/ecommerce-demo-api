ğŸ§© CONTINUAÃ‡ÃƒO DO PROJETO - CLEAN ARCHITECTURE (JAVA SPRING BOOT)

Objetivo:
Reestruturar o projeto ecommerce-demo-api seguindo a Clean Architecture (Uncle Bob),
com foco em separaÃ§Ã£o de camadas, modularizaÃ§Ã£o Maven, entidades ricas, exceÃ§Ãµes de domÃ­nio e testes de unidade via TDD.

------------------------------------------------------------
ğŸ— ESTRUTURA DE MÃ“DULOS
------------------------------------------------------------
ecommerce-entities            â†’ Enterprise Business Rules (Entities)
ecommerce-usecases            â†’ Application Business Rules (Use Cases)
ecommerce-interface-adapters  â†’ Interface Adapters (Controllers, Gateways)
ecommerce-frameworks-drivers  â†’ Frameworks & Drivers (DB, Kafka, Elasticsearch, Security)

Fluxo de dependÃªncia:
frameworks-drivers â†’ interface-adapters â†’ usecases â†’ entities

------------------------------------------------------------
âš™ï¸ STATUS ATUAL
------------------------------------------------------------
- Todos os pom.xml corrigidos e hierarquia Maven configurada.
- ReestruturaÃ§Ã£o feita de dentro para fora (entities â†’ usecases â†’ adapters â†’ frameworks).
- Entities Product, Order, User e relatÃ³rios refatoradas como entidades ricas.
- Casos de uso ajustados para usar mÃ©todos de domÃ­nio, sem recriar entidades.
- ExceÃ§Ãµes genÃ©ricas substituÃ­das por exceÃ§Ãµes especÃ­ficas de domÃ­nio.
- Regras de validaÃ§Ã£o e consistÃªncia encapsuladas dentro das entidades.
- PadrÃ£o de exceÃ§Ãµes centralizado na classe base DomainException.
- Testes unitÃ¡rios dos domÃ­nios Product, Order, User, UserAverageTicket e UserPurchaseSummary implementados via TDD com JUnit 5.

------------------------------------------------------------
ğŸ§± ENTIDADES REESTRUTURADAS
------------------------------------------------------------
Product
- MÃ©todos: create(), update(), decreaseStock(), increaseStock()
- ExceÃ§Ãµes: ValidationException, InsufficientStockException
- Garantias: nome nÃ£o vazio, preÃ§o > 0, estoque â‰¥ 0

Order
- MÃ©todos: create(), pay(), cancel(), addItem()
- ExceÃ§Ãµes: EmptyOrderException, InvalidOrderStateException, InvalidOrderTotalException
- Regras: pedido sem itens Ã© invÃ¡lido, total nÃ£o pode ser negativo, estado deve ser coerente

OrderItem
- Record imutÃ¡vel com validaÃ§Ã£o interna
- ExceÃ§Ãµes: InvalidQuantityException, InvalidPriceException
- Regra: quantidade > 0, preÃ§o > 0

User
- Usa enum UserRole (ADMIN / USER)
- MÃ©todos de domÃ­nio: register(), isAdmin(), isUser()
- ValidaÃ§Ã£o de formato de e-mail e papel do usuÃ¡rio

RelatÃ³rios
- UserAverageTicket â†’ ExceÃ§Ã£o: InvalidAverageTicketException
- UserPurchaseSummary â†’ ExceÃ§Ã£o: InvalidTotalSpentException
- Ambos definidos como records imutÃ¡veis e validados

------------------------------------------------------------
ğŸ§ª TESTES DE DOMÃNIO â€” PRODUCT (TDD)
------------------------------------------------------------
Classe: ProductTest
Framework: JUnit 5
Pacote: demo.ecommerce.entities.product

Casos cobertos:
1. shouldCreateProductWhenValidData
2. shouldThrowExceptionWhenNameIsBlank
3. shouldThrowExceptionWhenPriceIsZeroOrNegative
4. shouldThrowExceptionWhenStockIsNegative
5. shouldUpdateProductWhenValidData
6. shouldThrowExceptionWhenUpdatingWithInvalidData
7. shouldDecreaseStockWhenQuantityValid
8. shouldThrowExceptionWhenDecreaseStockBelowZero
9. shouldThrowExceptionWhenDecreaseStockWithZeroOrNegativeQuantity
10. shouldIncreaseStockWhenQuantityValid
11. shouldThrowExceptionWhenIncreaseStockWithZeroOrNegativeQuantity
12. shouldTrimNameOnCreateAndUpdate
13. shouldPreserveIdAndCreatedAtAfterUpdate

Resultado: cobertura completa das regras de negÃ³cio do domÃ­nio Product.

------------------------------------------------------------
ğŸ§ª TESTES DE DOMÃNIO â€” ORDER (TDD)
------------------------------------------------------------
Classe: OrderTest
Framework: JUnit 5
Pacote: demo.ecommerce.entities.order

Casos cobertos:
1. shouldCreateOrderWithValidItems
2. shouldThrowExceptionWhenCreatingWithEmptyItems
3. shouldCreateOrderWithCanceledStatusWhenAnyItemOutOfStock
4. shouldPayOrderWhenStatusIsPending
5. shouldThrowExceptionWhenPayingNonPendingOrder
6. shouldCancelOrderWhenPending
7. shouldThrowExceptionWhenCancelingPaidOrder
8. shouldAddItemWhenOrderIsPending
9. shouldThrowExceptionWhenAddingItemToNonPendingOrder
10. shouldRecalculateTotalWhenItemsAdded
11. shouldThrowExceptionWhenItemPriceIsNegative
12. shouldThrowExceptionWhenTotalAmountIsNegative
13. shouldPreserveIdUserIdAndCreatedAt

Resultado: cobertura completa das regras de negÃ³cio e transiÃ§Ãµes de estado do domÃ­nio Order.

------------------------------------------------------------
ğŸ§ª TESTES DE DOMÃNIO â€” USER (TDD)
------------------------------------------------------------
Classe: UserTest
Pacote: demo.ecommerce.entities.user

Casos cobertos:
1. shouldRegisterUserWithValidData
2. shouldSetIdAndCreatedAtOnRegister
3. shouldThrowExceptionWhenEmailHasInvalidFormat
4. shouldThrowExceptionWhenNameIsNull
5. shouldThrowExceptionWhenEmailIsNull
6. shouldThrowExceptionWhenPasswordHashIsNull
7. shouldThrowExceptionWhenRoleIsNull
8. shouldReturnTrueForIsAdminWhenRoleAdmin
9. shouldReturnTrueForIsUserWhenRoleUser
10. shouldReturnFalseForIsAdminWhenRoleUser
11. shouldReturnFalseForIsUserWhenRoleAdmin
12. shouldGenerateDifferentIdsForDifferentRegistrations
13. shouldBeImmutable

Resultado: cobertura completa das regras de negÃ³cio e validaÃ§Ãµes do domÃ­nio User.

------------------------------------------------------------
ğŸ§ª TESTES DE DOMÃNIO â€” USER AVERAGE TICKET (TDD)
------------------------------------------------------------
Classe: UserAverageTicketTest
Pacote: demo.ecommerce.entities.user

Casos cobertos:
1. shouldCreateWhenAverageTicketIsPositive
2. shouldCreateWhenAverageTicketIsZero
3. shouldAcceptPositiveValuesWithDifferentScales
4. shouldThrowExceptionWhenAverageTicketIsNull
5. shouldThrowExceptionWhenAverageTicketIsNegative

Resultado: validaÃ§Ã£o completa das regras de negÃ³cio do record UserAverageTicket.

------------------------------------------------------------
ğŸ§ª TESTES DE DOMÃNIO â€” USER PURCHASE SUMMARY (TDD)
------------------------------------------------------------
Classe: UserPurchaseSummaryTest
Pacote: demo.ecommerce.entities.user

Casos cobertos:
1. shouldCreateWhenTotalSpentIsPositive
2. shouldCreateWhenTotalSpentIsZero
3. shouldAcceptPositiveValuesWithDifferentScales
4. shouldThrowExceptionWhenTotalSpentIsNull
5. shouldThrowExceptionWhenTotalSpentIsNegative

Resultado: validaÃ§Ã£o completa das regras de negÃ³cio do record UserPurchaseSummary.

------------------------------------------------------------
ğŸ’¥ EXCEÃ‡Ã•ES DE DOMÃNIO
------------------------------------------------------------
DomainException (base) â†’ raiz para todas as exceÃ§Ãµes do domÃ­nio
ValidationException / InvalidFieldException â†’ validaÃ§Ãµes genÃ©ricas
InsufficientStockException â†’ estoque insuficiente
InvalidOrderStateException â†’ transiÃ§Ã£o de estado invÃ¡lida
EmptyOrderException â†’ pedido sem itens
InvalidOrderTotalException â†’ total negativo ou nulo
InvalidQuantityException â†’ quantidade â‰¤ 0
InvalidPriceException â†’ preÃ§o â‰¤ 0
InvalidAverageTicketException â†’ ticket mÃ©dio invÃ¡lido
InvalidTotalSpentException â†’ total gasto invÃ¡lido

------------------------------------------------------------
ğŸ“„ DOCUMENTOS DE REFERÃŠNCIA
------------------------------------------------------------
- Caso tÃ©cnico.pdf
- Fluxo de interaÃ§Ã£o.pdf

------------------------------------------------------------
ğŸ“Œ COMO CONTINUAR
------------------------------------------------------------
Cole este prompt em um novo chat e diga:
"Continuar a partir deste contexto de reestruturaÃ§Ã£o da Clean Architecture com exceÃ§Ãµes de domÃ­nio e testes TDD dos domÃ­nios Product e Order."




ecommerce-usecases
â””â”€â”€ src/main/java/demo/ecommerce/usecases
    â”œâ”€â”€ common
    â”‚   â”œâ”€â”€ UseCase.java                 // interface genÃ©rica UseCase<I,O>
    â”‚   â”œâ”€â”€ Command.java / Query.java    // marcadores opcionais p/ CQRS
    â”‚   â”œâ”€â”€ VoidUseCase.java             // Ãºtil para casos sem retorno
    â”‚   â””â”€â”€ exceptions
    â”‚       â””â”€â”€ NotFoundException.java   // exceÃ§Ã£o de aplicaÃ§Ã£o (nÃ£o-domÃ­nio)
    â”œâ”€â”€ ports
    â”‚   â”œâ”€â”€ ProductRepository.java       // portas (interfaces) de saÃ­da
    â”‚   â”œâ”€â”€ ClockProvider.java
    â”‚   â”œâ”€â”€ IdGenerator.java
    â”‚   â””â”€â”€ EventPublisher.java          // opcional (domÃ­nioâ†’aplicaÃ§Ã£o)
    â””â”€â”€ product
        â”œâ”€â”€ command
        â”‚   â”œâ”€â”€ CreateProduct
        â”‚   â”‚   â”œâ”€â”€ CreateProductInput.java
        â”‚   â”‚   â”œâ”€â”€ CreateProductOutput.java
        â”‚   â”‚   â””â”€â”€ CreateProductInteractor.java
        â”‚   â”œâ”€â”€ UpdateProduct
        â”‚   â”‚   â”œâ”€â”€ UpdateProductInput.java
        â”‚   â”‚   â”œâ”€â”€ UpdateProductOutput.java
        â”‚   â”‚   â””â”€â”€ UpdateProductInteractor.java
        â”‚   â”œâ”€â”€ DeleteProduct
        â”‚   â”‚   â”œâ”€â”€ DeleteProductInput.java
        â”‚   â”‚   â””â”€â”€ DeleteProductInteractor.java
        â”‚   â””â”€â”€ AdjustProductStock
        â”‚       â”œâ”€â”€ AdjustProductStockInput.java   // {productId, delta}
        â”‚       â””â”€â”€ AdjustProductStockInteractor.java
        â””â”€â”€ query
            â”œâ”€â”€ GetProductById
            â”‚   â”œâ”€â”€ GetProductByIdInput.java
            â”‚   â”œâ”€â”€ GetProductByIdOutput.java
            â”‚   â””â”€â”€ GetProductByIdInteractor.java
            â””â”€â”€ SearchProducts
                â”œâ”€â”€ SearchProductsInput.java
                â”œâ”€â”€ SearchProductsOutput.java
                â””â”€â”€ SearchProductsInteractor.java